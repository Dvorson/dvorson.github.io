---
import Layout from '../../layouts/Layout.astro';
import PainPoint from '../../components/PainPoint.astro';
import CTABanner from '../../components/CTABanner.astro';
import FAQSection from '../../components/FAQSection.astro';
import services from '../../data/services.json';
import matrix from '../../data/industry-matrix.json';

export function getStaticPaths() {
  return matrix.pages.map((page) => ({
    params: { slug: page.slug },
    props: { page }
  }));
}

const { page } = Astro.props;
const { iconPaths, solutions, caseStudies } = services;

// Get the parent solution
const parentSolution = solutions.find(s => s.id === page.relatedSolution);
// Get the related case study
const relatedCS = caseStudies.find(cs => cs.id === page.relatedCaseStudy);
// Get industry info
const industry = matrix.industries.find(i => i.id === page.industry);

// Generate FAQs from the page data
const faqs = [
  {
    question: `How long does it take to implement ${parentSolution?.shortTitle || 'AI'} for ${industry?.name || 'this industry'}?`,
    answer: `A focused proof-of-concept typically takes 4-8 weeks. Production deployment with full integration, monitoring, and testing usually runs 8-16 weeks depending on the complexity of your existing systems and data landscape.`
  },
  {
    question: `Do you have experience with ${industry?.name || 'this industry'} specifically?`,
    answer: `Yes. My 12+ years of enterprise delivery include direct experience across retail, telecom, media, and e-commerce. I understand the operational constraints, compliance requirements, and technology landscapes specific to ${industry?.name || 'your industry'}.`
  },
  {
    question: `Can this work with our existing systems?`,
    answer: `Absolutely. I design integrations that connect to your existing infrastructure — whether that's legacy systems, cloud platforms, or specialized industry software. The goal is to add AI capabilities without requiring a platform rewrite.`
  },
  {
    question: `What's the typical investment?`,
    answer: `${parentSolution?.pricing?.range || 'EUR 15,000 - 80,000'} ${parentSolution?.pricing?.unit || 'per project'}, depending on scope and integration complexity. I provide fixed-price proposals after a discovery call so there are no surprises.`
  }
];

// Service schema
const serviceSchema = {
  '@context': 'https://schema.org',
  '@type': 'Service',
  name: page.title,
  description: page.subheadline,
  url: `https://dvorson.github.io/ai/${page.slug}`,
  provider: {
    '@type': 'Person',
    name: 'Anton Dvorson',
    url: 'https://dvorson.github.io'
  },
  areaServed: ['Netherlands', 'Europe'],
  serviceType: page.title
};
---

<Layout
  title={page.seoTitle}
  description={page.seoDescription}
  ogImage={`/og/ai-${page.slug}.png`}
  url={`https://dvorson.github.io/ai/${page.slug}`}
  canonical={`https://dvorson.github.io/ai/${page.slug}`}
  additionalSchema={[serviceSchema]}
>
  <!-- Hero -->
  <section class="relative overflow-hidden bg-gradient-to-br from-slate-50 via-white to-blue-50 rounded-2xl p-8 sm:p-12 mb-16 border border-gray-100">
    <div class="absolute -top-24 -right-24 w-64 h-64 bg-gradient-to-br from-blue-100/40 to-indigo-100/40 rounded-full blur-3xl"></div>
    <div class="absolute -bottom-16 -left-16 w-48 h-48 bg-gradient-to-br from-gray-100/30 to-slate-100/30 rounded-full blur-3xl"></div>

    <div class="relative max-w-3xl">
      <div class="flex items-center gap-2 mb-3">
        <span class="text-sm font-semibold text-blue-600 uppercase tracking-wider">{parentSolution?.shortTitle}</span>
        <span class="text-gray-300">|</span>
        <span class="text-sm font-semibold text-gray-500 uppercase tracking-wider">{industry?.name}</span>
      </div>
      <h1 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-gray-900 mb-6 tracking-tight leading-tight">
        {page.headline}
      </h1>
      <p class="text-xl text-gray-600 mb-8 leading-relaxed max-w-2xl">
        {page.subheadline}
      </p>
      <a href="https://linkedin.com/in/dvorson" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center px-8 py-4 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md">
        Discuss Your {industry?.name} Challenge
        <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
        </svg>
      </a>
    </div>
  </section>

  <!-- Pain Points -->
  <section class="mb-16">
    <div class="section-header">
      <h2>Sound familiar?</h2>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      {page.painPoints.map((pain, i) => (
        <PainPoint text={pain} index={i + 1} />
      ))}
    </div>
  </section>

  <!-- Use Cases -->
  <section class="mb-16">
    <div class="section-header">
      <h2>What {parentSolution?.shortTitle} can do for {industry?.name?.toLowerCase()}</h2>
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      {page.useCases.map((useCase, i) => (
        <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-all duration-200">
          <div class="flex items-start gap-4">
            <div class="w-10 h-10 bg-blue-600 text-white rounded-xl flex items-center justify-center font-bold text-lg flex-shrink-0">
              {i + 1}
            </div>
            <p class="text-gray-700 leading-relaxed">{useCase}</p>
          </div>
        </div>
      ))}
    </div>
  </section>

  <!-- Related Case Study -->
  {relatedCS && (
    <section class="mb-16">
      <h2 class="text-2xl font-bold text-gray-900 mb-6">Related project</h2>
      <a href={relatedCS.hasFullPage ? `/case-studies/${relatedCS.slug}` : '/case-studies'} class="group block bg-white rounded-xl p-6 shadow-sm border border-gray-100 hover:shadow-md hover:border-blue-200 transition-all duration-200">
        <div class="flex items-center gap-3 mb-2">
          <span class="inline-block px-3 py-1 bg-blue-50 text-blue-700 text-xs font-semibold rounded-full">
            {relatedCS.domain}
          </span>
          <span class="text-sm text-gray-400">{relatedCS.duration}</span>
        </div>
        <h3 class="text-lg font-bold text-gray-900 group-hover:text-blue-600 transition-colors mb-1">{relatedCS.title}</h3>
        <p class="text-sm text-gray-500 mb-3">{relatedCS.client}</p>
        <div class="bg-green-50 border border-green-100 rounded-lg px-4 py-3">
          <p class="text-sm text-green-800 font-medium">{relatedCS.outcomes[0]}</p>
        </div>
      </a>
    </section>
  )}

  <!-- Parent Solution Link -->
  {parentSolution && (
    <section class="mb-16">
      <div class="bg-blue-50 border border-blue-100 rounded-xl p-6">
        <h2 class="text-lg font-bold text-gray-900 mb-2">Learn more about {parentSolution.shortTitle}</h2>
        <p class="text-gray-600 text-sm mb-4">{parentSolution.subheadline.slice(0, 150)}...</p>
        <a href={`/solutions/${parentSolution.slug}`} class="inline-flex items-center text-blue-600 font-semibold text-sm hover:text-blue-700 transition-colors">
          View full {parentSolution.shortTitle} solution
          <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
          </svg>
        </a>
      </div>
    </section>
  )}

  <!-- FAQ -->
  <section class="mb-16">
    <div class="section-header">
      <h2>Common questions</h2>
    </div>
    <FAQSection faqs={faqs} />
  </section>

  <!-- CTA -->
  <CTABanner
    headline={`Ready to bring ${parentSolution?.shortTitle || 'AI'} to your ${industry?.name?.toLowerCase() || 'business'}?`}
    description="Let's talk about your specific challenge. 30 minutes, no pitch — just an honest assessment of how AI can help."
    ctaText="Let's Talk on LinkedIn"
  />

  <!-- Navigation -->
  <div class="flex items-center justify-between mb-8">
    <a href={`/solutions/${parentSolution?.slug || ''}`} class="inline-flex items-center text-sm text-gray-400 hover:text-gray-600 font-medium transition-colors">
      <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16l-4-4m0 0l4-4m-4 4h18" />
      </svg>
      {parentSolution?.shortTitle} solutions
    </a>
    <a href="/solutions" class="inline-flex items-center text-sm text-gray-400 hover:text-gray-600 font-medium transition-colors">
      All solutions
      <svg class="w-4 h-4 ml-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3" />
      </svg>
    </a>
  </div>
</Layout>
